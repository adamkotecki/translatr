{namespace sbt=SourceBroker\Translatr\ViewHelpers}

<f:layout name="Default" />

<f:section name="content">
    <f:flashMessages />
    <f:render partial="Label/DemandForm" arguments="{_all}" />

    <f:if condition="{labels}">
        <table class="table table-hover">
            <thead>
            <tr class="t3-row-header">
                <th>Key</th>
                <th>Label (Default)</th>
                <f:if condition="{demand.sysLanguageUid} > 0">
                    <th>Label ({currentLanguageTitle})</th>
                </f:if>
            </tr>
            </thead>
            <tbody>
            <f:for each="{labels}" as="label">
                <tr data-uid="{label.uid}" data-l10nparent="{label.l10n_parent}">
                    <td>
                        {label.ukey}
                        <f:if condition="{label.description}">
                            <span class="t3-icon t3-icon-actions t3-icon-actions-document t3-icon-document-info t3-help-teaser"
                                  title="{label.description}"></span>
                        </f:if>
                    </td>
                    <td>
                        <f:render section="actionButtons" arguments="{
                            label: label
                        }" />

                        {label.text}
                    </td>
                    <f:if condition="{demand.sysLanguageUid} > 0">
                        <td>
                            <f:for each="{label.language_childs}" as="childLabel">
                                <f:if condition="{childLabel.sys_language_uid} == {demand.sysLanguageUid}">
                                    <f:render section="actionButtons" arguments="{
                                        label: childLabel,
                                        parentLabel: label
                                    }" />

                                    {childLabel.text}
                                </f:if>
                            </f:for>
                        </td>
                    </f:if>
                </tr>
            </f:for>
            </tbody>
        </table>
    </f:if>
</f:section>

<f:section name="actionButtons">
    <div class="btn-group" role="group">
        <f:render section="actionButtonEdit" arguments="{label: label}" />
        <f:render section="actionButtonHide" arguments="{label: label}" />
        <f:render section="actionButtonRemove" arguments="{label: label}" />
        <f:if condition="{parentLabel}">
            <f:if condition="{label}">
                <f:else>
                    <f:render section="actionButtonLocalize" arguments="{label: parentLabel}" />
                </f:else>
            </f:if>
        </f:if>
    </div>
</f:section>

<f:section name="actionButtonHide">
    <a href="#"
       class="btn btn-default t3js-record-hide"
       data-state="{f:if(condition: label.hidden, then: 'hidden', else: 'visible')}"
       data-params="data[tx_translatr_domain_model_label][{label.uid}][hidden]={f:if(condition: label.hidden, then: '0', else: '1')}"
       title=""
       data-toggle-title="{f:if(condition: label.hidden, then: 'Hide record', else: 'Un-hide record')}"
       data-original-title="{f:if(condition: label.hidden, then: 'Un-hide record', else: 'Hide record')}"
    >
        <span class="t3js-icon icon icon-size-small icon-state-default icon-actions-edit-hide" data-identifier="actions-edit-hide">
            <span class="icon-markup">
                <img src="/typo3/sysext/core/Resources/Public/Icons/T3Icons/actions/actions-edit-{f:if(condition: label.hidden, then: 'unhide', else: 'hide')}.svg" width="16" height="16">
            </span>
        </span>
    </a>
</f:section>

<f:section name="actionButtonEdit">
    <a href="{sbt:be.actionLink(type: 'edit', label: label)}" class="btn btn-default">
        <span class="t3js-icon icon icon-size-small icon-state-default icon-actions-open" data-identifier="actions-open">
            <span class="icon-markup">
                <img src="/typo3/sysext/core/Resources/Public/Icons/T3Icons/actions/actions-document-open.svg" width="16" height="16">
            </span>
        </span>
    </a>
</f:section>

<f:section name="actionButtonRemove">
    <a href="#"
       class="btn btn-default t3js-record-delete"
       data-l10parent="{label.l10n_parent}"
       data-params="cmd[tx_translatr_domain_model_label][{label.uid}][delete]=1"
       data-title="{label.text}"
       data-message='Are you sure you want to delete "{label.text}" record?'
       title=""
       data-original-title="Delete record (!)"
    >
        <span class="t3js-icon icon icon-size-small icon-state-default icon-actions-edit-delete"
              data-identifier="actions-edit-delete">
            <span class="icon-markup">
                <img src="/typo3/sysext/core/Resources/Public/Icons/T3Icons/actions/actions-edit-delete.svg"
                     width="16" height="16">
            </span>
        </span>
    </a>
</f:section>

<f:section name="actionButtonLocalize">
    <a href="{sbt:be.actionLink(type: 'localize', label: label, options: '{sysLanguageUid: demand.sysLanguageUid}')}" class="btn btn-default">
        <span class="t3js-icon icon icon-size-small icon-state-default icon-actions-open" data-identifier="actions-open">
            <span class="icon-markup">
                <img src="/typo3/sysext/core/Resources/Public/Icons/T3Icons/actions/actions-document-open.svg" width="16" height="16">
            </span>
        </span>
    </a>
</f:section>